clear all
close all
clc

wz28 = load('mnist_012.mat');
test28 = wz28.test_images;
train28 = wz28.train_images;

wz41 = [-1,-1,-1,-1;
         1, 1, 1, 1;
         1, 1, 1, 1;
        -1,-1,-1,-1];

bl41 = [-1,1,-1,-1;
         1, 1, 1,-1;
         1, 1, 1, 1;
        -1,-1,1,-1];

wz42 = [ 1,-1,-1, 1;
         1,-1,-1, 1;
         1,-1,-1, 1;
         1,-1,-1, 1];

wz43 = [ 1,-1,-1, 1;
        -1, 1, 1,-1;
        -1, 1, 1,-1;
         1,-1,-1, 1];

wz44 = [ 1, 1, 1, 1;
        -1,-1,-1,-1;
        -1,-1,-1,-1;
         1, 1, 1, 1];

wz45 = [-1,-1,-1,-1;
        1,1,1,1;
        1,1,1,1;
        -1,-1,-1,-1;
                ];

wz46 = [1,-1,-1,1;
       -1,-1,-1,-1;
       -1,-1,-1,-1;
        1,-1,-1,1;
                ];

wz61 = [ 1, -1, -1, -1, -1,  1;
           -1,  1, -1, -1,  1, -1;
           -1, -1,  1,  1, -1, -1;
           -1, -1,  1,  1, -1, -1;
           -1,  1, -1, -1,  1, -1;
            1, -1, -1, -1, -1,  1];

bl61 = [ 1, -1, -1, -1, -1,  1;
           -1,  1, 1, -1,  1, -1;
           -1, -1,  1,  -1, -1, -1;
           -1, -1,  1,  1, 1, -1;
           1,  1, -1, -1,  1, -1;
            1, -1, -1, -1, -1,  1];


wz62 = [ 1,-1,-1,-1,-1, 1;
         1,-1,-1,-1,-1, 1;
         1,-1,-1,-1,-1, 1;
         1,-1,-1,-1,-1, 1;
         1,-1,-1,-1,-1, 1;
         1,-1,-1,-1,-1, 1];

wz63 =[ 1, -1,  1, -1,  1, -1;
           -1,  1, -1,  1, -1,  1;
            1, -1,  1, -1,  1, -1;
           -1,  1, -1,  1, -1,  1;
            1, -1,  1, -1,  1, -1;
           -1,  1, -1,  1, -1,  1];

wz64 = [ 1, 1, 1, 1, 1, 1;
        -1,-1,-1,-1,-1,-1;
        -1,-1,-1,-1,-1,-1;
        -1,-1,-1,-1,-1,-1;
        -1,-1,-1,-1,-1,-1;
         1, 1, 1, 1, 1, 1];

wz65 = [-1,-1,-1,-1,-1,-1;
         1, 1, 1, 1, 1, 1;
         1, 1, 1, 1, 1, 1;
         1, 1, 1, 1, 1, 1;
         1, 1, 1, 1, 1, 1;
        -1,-1,-1,-1,-1,-1];

wz66 = [-1, -1,  1,  1, -1, -1;
           -1, -1,  1,  1, -1, -1;
            1,  1,  1,  1,  1,  1;
            1,  1,  1,  1,  1,  1;
           -1, -1,  1,  1, -1, -1;
           -1, -1,  1,  1, -1, -1];

figure
imshow([wz41,wz42,wz43,wz44,wz45,wz46])

figure
imshow([wz61,wz62,wz63,wz64,wz65,wz66])

wz281 = double(train28(:,:,123));
wz282 = double(train28(:,:,5));
wz283 = double(train28(:,:,56));
wz284 = double(train28(:,:,2));
wz285 = double(train28(:,:,32));
wz286 = double(train28(:,:,176));

wz281(wz281==0) = -1;
wz282(wz282==0) = -1;
wz283(wz283==0) = -1;
wz284(wz284==0) = -1;
wz285(wz285==0) = -1;
wz286(wz286==0) = -1;

figure
imshow([wz281,wz282,wz283,wz284,wz285,wz286]);

szum10 = imnoise(wz281,'salt & pepper',0.1);
szum10(szum10==0) = -1;
szum40 = imnoise(wz281,'salt & pepper',0.4);
szum40(szum40==0) = -1;
szum80 = imnoise(wz281,'salt & pepper',0.8);
szum80(szum80==0) = -1;

% Dla reguły Hebba

%%%%%%%    4x4  %%%%%%%%%%%%%%%%%%%%%

[y41,y42,y43,k41,k42,k43,W41,W42,W43] = Hebb(bl41,10,wz41,wz42,wz43,wz44,wz45,wz46);

%%%%%%%%%%5 6x6 %%%%%%%%%%%%%%%%%%%55

[y61,y62,y63,k61,k62,k63,W61,W62,W63] = Hcos(bl61,10,wz61,wz62,wz63,wz64,wz65,wz66);


%%%%%%%%% 28x28 %%%%%%%%%%%%%%%%


[~,~,yszum10,~,~,kszum10,~,~,Wszum10] = Hcos(szum10,100,wz281,wz282,wz283,wz284,wz285,wz286);

[~,~,yszum40,~,~,kszum40,~,~,Wszum40] = Hcos(szum40,100,wz281,wz282,wz283,wz284,wz285,wz286);

[~,~,yszum80,~,~,kszum80,~,~,Wszum80] = Hcos(szum80,200,wz281,wz282,wz283,wz284,wz285,wz286);

% Dla reguły pseudoinwersji

%%%%%%%    4x4  %%%%%%%%%%%%%%%%%%%%%

[ypi41,ypi42,ypi43,kpi41,kpi42,kpi43,Wpi41,Wpi42,Wpi43] = PPPP(bl41,10,wz41,wz42,wz43,wz44,wz45,wz46);

%%%%%%%%%%5 6x6 %%%%%%%%%%%%%%%%%%%55

[ypi61,ypi62,ypi63,kpi61,kpi62,kpi63,Wpi61,Wpi62,Wpi63] = PPPP(bl61,10,wz61,wz62,wz63,wz64,wz65,wz66);

%%%%%%%%% 28x28 %%%%%%%%%%%%%%%%


[~,~,yszumPI10,~,~,kszumPI10,~,~,WszumPI10] = PPPP(szum10,100,wz281,wz282,wz283,wz284,wz285,wz286);

[~,~,yszumPI40,~,~,kszumPI40,~,~,WszumPI40] = PPPP(szum40,100,wz281,wz282,wz283,wz284,wz285,wz286);

[~,~,yszumPI80,~,~,kszumPI80,~,~,WszumPI80] = PPPP(szum80,200,wz281,wz282,wz283,wz284,wz285,wz286);
